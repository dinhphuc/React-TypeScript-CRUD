"use strict";function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,i){for(var t=0;t<i.length;t++){var o=i[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(i,t,o){return t&&e(i.prototype,t),o&&e(i,o),i}}();!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery||window.Zepto)}(function(e,i){e.imgPreview=function(e){return new t(e)};var t=function(){function i(e){_classCallCheck(this,i),this.init(e)}return _createClass(i,[{key:"init",value:function(i){var t=this;this.config=e.extend(!0,{},{el:"[data-pic]",attr:"data-pic",attrTitle:"data-pic-title",attrDesc:"data-pic-desc",mode:"single",isMaskShow:!0,maskBgColor:"rgba(0,0,0,.5)"},i),this.allDom().each(function(i,o){var n=t;e(o).off("click").on("click",function(e){return n.preview(o,e)})})}},{key:"preview",value:function(i,t){t=t||window.event,t.preventDefault();var o=this,n=[e(window),e("body"),e(i)],r=n[0],a=n[1],c=n[2],s=[r.width(),r.height()],v=s[0],l=s[1],f=[c.attr(o.config.attr),c.attr(o.config.attrTitle),c.attr(o.config.attrDesc)],d=f[0],g=f[1],u=f[2],p=[t.clientX,t.clientY],w=p[0],m=p[1];if(o.imgPreviewMask=e('<div class="img-preview-mask" style="background-color: '+(o.config.maskBgColor||"rgba(0,0,0,.5)")+'"></div>'),o.imgPreviewPopover=e('<div class="img-preview-popover" style="top: '+m+"px;left: "+w+'px;"></div>'),o.imgPreviewBox=e('<div class="img-preview-box"></div>'),o.imgPreviewFoot=e('<div class="img-preview-foot"></div>'),"single"===o.config.mode){var P=new Image,h=function(i,t){t=o.isPc()?parseInt(v*t/i):t>=l?l:t,i=i>=v?v:i;var n={width:i,height:o.isPc()?"auto":t,top:parseInt((l-t)/2),left:parseInt((v-i)/2)};o.imgPreviewBox.append(e('<img width="100%" style="cursor: zoom-out" src="'+d+'"/>')).click(function(){o.hide()}),o.config.isMaskShow&&(a.append(o.imgPreviewMask),o.imgPreviewMask.click(function(){o.hide()})),o.config.attrTitle&&o.imgPreviewFoot.append(e('<div class="img-foot-title">'+(g||"")+"</div>")),o.config.attrDesc&&o.imgPreviewFoot.append(e('<div class="img-foot-desc">'+(u||"")+"</div>")),o.imgPreviewPopover.append(o.imgPreviewBox),(g||u)&&o.imgPreviewPopover.append(o.imgPreviewFoot),a.append(o.imgPreviewPopover),e.fn&&e.fn.jquery?o.imgPreviewPopover.animate(n,300):o.imgPreviewPopover.css(n)};P.onload=function(){P.onload=null,h(P.width,P.height)},P.onerror=function(){alert("很抱歉，图片加载失败！")},P.src=d}}},{key:"isPc",value:function(){return/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)}},{key:"hide",value:function(){this.imgPreviewMask.remove(),this.imgPreviewPopover.remove()}},{key:"allDom",value:function(){return e(this.config.el)}}]),i}()});